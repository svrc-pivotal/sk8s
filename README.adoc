== Prerequisites

a running 1.7 Kubernetes cluster (instructions assume minikube for now)

== Build

```
eval $(minikube docker-env)
./mvnw clean package
./dockerize
```

== Create Kafka/Zookeeper

```
kubectl apply -f config/kafka
```

== Deploy

```
kubectl apply -f config
```

== Create a Handler

```
kubectl create -f samples/shell-handler.yaml
```

== Create a Topic

```
kubectl create -f samples/greetings-topic.yaml
```

== Create a Function

```
kubectl create -f samples/echo-function.yaml
```

== Publish a Message to the Topic

```
./publish greetings hello
```

== Watch Results on Minikube

```
minikube ssh
tail -f /messages/greetings.log
```

== Tear it all down

```
kubectl delete functions --all
kubectl delete handlers --all
kubectl delete topics --all
kubectl delete all -l app=topic-controller
kubectl delete all -l app=topic-gateway
kubectl delete all -l app=event-dispatcher
kubectl delete crd/functions.extensions.sk8s.io
kubectl delete crd/topics.extensions.sk8s.io
kubectl delete crd/handlers.extensions.sk8s.io
kubectl delete jobs -l function=echo
kubectl delete all -l app=kafka
```
